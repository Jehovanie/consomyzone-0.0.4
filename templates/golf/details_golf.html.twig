<div class="description content_body_details_jheo_js" id="details-coord"
    data-toggle-type="golf"
    data-toggle-latitude="{{((details.latitude) ? details.latitude : '0' )|format_number({fraction_digit: 6})}}" 
    data-toggle-longitude="{{((details.longitude) ? details.longitude : '0')|format_number({fraction_digit: 6})}}" 
    data-toggle-nameferme="{{details.nomGolf}}"
    data-toggle-id-golf="{{details.id}}"
    data-toggle-user-id="{{app.user ? app.user.id : 0}}"
>

    <div class="content_titre_details">
        <figure class="text-center mt-4">
            <blockquote class="blockquote">
                <div class="row">
                    <div class="col-8">
                        <p> 
                            {{details.nomGolf | upper}}  

                            {% if (app.user and app.user.type != 'Type') %}
                                {% if details.user_status["a_faire"] == null and  details.user_status["fait"] == null and  details.user_status["mon_golf"] == null and  details.user_status["refaire"] == null %}
                                    <span class="badge bg-info golf_status golf_status_jheo_js"></span>
                                {% else %}

                                    {% if ( details.user_status["a_faire"] == "1" ) %}
                                        <span class="badge bg-info  golf_status golf_status_jheo_js">A FAIRE</span> 
                                    {% elseif (details.user_status["fait"] == "1") %}
                                        <span class="badge bg-info  golf_status golf_status_jheo_js">FAIT</span> 
                                    {# {% elseif (details.user_status["mon_golf"] == "1") %} #}
                                        {# <span class="badge bg-info  golf_status golf_status_jheo_js">MON GOLF</span>  #}
                                    {% elseif (details.user_status["refaire"] == "1") %}
                                        <span class="badge bg-info  golf_status golf_status_jheo_js">A REFAIRE</span> 
                                    {% else %}
                                        <span class="badge bg-info  golf_status golf_status_jheo_js"></span>
                                    {% endif %}

                                {% endif %}

                            {% endif %}

                        </p>
                    </div>
                    <div class="col-4">
                        <div class="logo-pastille-golf-tomm-js" style="width: 500px" onclick='isPastilledList({{details.id}},"{{details.nomGolf|replace({'"': '&quot;', "'": '&apos;'}) | raw}}")'>
                            {% set count = 0 %}
                            {% for tribu_t_pastilled in tribu_t_pastilleds %}
                                {# {{ dump(tribu_t_pastilled) }} #}
                                    {% if tribu_t_pastilled.isPastilled == true %}
                                        {% set count = count + 1 %}
                                    {% endif %}
                                {% if tribu_t_pastilled['isPastilled'] == true %}
                                    {% if tribu_t_pastilled['logo_path'] == "" %}
                                        <img class="logo_path_pastille_details logo_path_{{tribu_t_pastilled['table_name']}}_tomm_js logo_path_pastille_details-tomm-js" src="/public/uploads/tribu_t/photo/avatar_tribu.jpg" alt="te">
                                    {% else %}
                                        <img class="logo_path_pastille_details logo_path_{{tribu_t_pastilled['table_name']}}_tomm_js logo_path_pastille_details-tomm-js" src="{{tribu_t_pastilled['logo_path']}}" alt="">
                                    {% endif %}
                                    
                                
                                {% endif %}
                                
                            {% endfor %}
                            
                            {% if count > 4 %}
                                <span class="length-pastille-plus">{{ count }}+</span>
                            {% else %}
                                <span class="length-pastille-plus"></span>
                            {% endif %}
                        </div>
                    </div>
                    
                </div>
            </blockquote>
            <figcaption class="blockquote-footer">
               Adresse :  <a href="#" class="small text-center ">{{details.adr1 | raw}}  {{details.cp  | raw}}  {{details.nomCommune  | raw}}</a>
            </figcaption> 

            {% if (app.user and app.user.type != 'Type') %}
                <div class="mt-3 content_btn_golf_did_jheo_js" id="containerActionGolf">
                    {% if details.user_status["a_faire"] == null and  details.user_status["fait"] == null and  details.user_status["mon_golf"] == null and  details.user_status["refaire"] == null%}

                        <label for="selectActionGolf" class="form-label">Comment voulez-vous marquer ce golf ?  </label>
                        <select class="form-select select_action_golf_nanta_js" id="selectActionGolf" name="sellist_action" data-id="{{details.id}}" onchange="executeActionForPastGolf(event,{{details.id}})">
                            <option value="0">Aucun</option>
                            <option value="1">A faire</option>
                            <option value="2">Fait</option>
                            <option value="3">A refaire</option>
                            {# <option value="4">Mon golf</option> #}
                        </select>
                        {# <button class="btn btn-primary btn-sm mt-3" type="button" onclick="executeActionForPastGolf({{details.id}})">Terminer</button> #}
                    {% else %}
                        Voulez-vous annuler votre choix ? <span class="badge bg-danger btn_golf_did  btn_golf_did_jheo_js" onclick="cancelGolfFinished(event,{{details.id}})">Oui</span>
                    {% endif %}
                </div>
                <div class="mon-golf">
                    <p>voulez-vous pastiller avec un autre tribu ou depastiller?</p>
                    <button class="btn btn-success" value="3" onclick='executeActionForPastMonGolf("{{details.id}}","{{details.nomGolf|replace({'"': '&quot;', "'": '&apos;'}) | raw}}","{{details.adr1|replace({'"': '&quot;', "'": '&apos;'}) | raw}}  {{details.cp  | raw}}  {{details.nomCommune  | raw}}" )'>Mon golf</button>
                </div>
            {% endif %}
                
            {# {% set adresse = details.adr1|lower ~" "~ details.cp|lower ~" "~ details.nomCommune|lower %}
            <button class="btn btn-outline-primary mx-auto w-50 mb-2 mt-2" onclick="openVoirPlusChearch('{{details.nomGolf | raw}}','{{adresse | trim}}', 'golf')">Voir plus</button>  #}
        </figure>
       
    </div>

    <div class="p-4">
        <div class="content_note mb-3">
            <div class="text-center start start_jheo_js">
                {% set rate = details.avis.note != 0 ?  details.avis.note - (details.avis.note|number_format - 1): 0 %}

                {% set rateYellow = rate * 100  %}
                {% set rateBlack = 100 - rateYellow %}

                {% for item in 0..3 %}
                    {% if item < details.avis.note|number_format - 1 %}
                        <i class="fa-solid fa-star checked" style="color: rgb(245, 209, 101);"></i>
                    {% else %}
                        {% if rate != 0 %}
                            <i class="fa-solid fa-star" data-rank="1" style ="{{ "background: linear-gradient(90deg, #F5D165 " ~  rateYellow ~ "%, #000 " ~ rateBlack ~ "%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;" }}"></i>
                            {% set rate = 0 %}
                        {% else %}
                            <i class="fa-solid fa-star" data-rank="1"></i>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </div>
             <hr>
            <div class="mt-2 nombre_avis d-flex justify-content-center align-items-center">
                {# <button class="btn btn-secondary btn-md see-avis btn_grise_non_actif_js_Elie" onclick="openSwalNonActif()" data-bs-toggle="modal" data-bs-target="#staticBackdrop">Avis</button> #}
                {# <button class="btn btn-secondary btn-md see-avis btn_grise_non_actif_js_Elie" onclick="openSwalNonActif()">Avis</button> #}
                <span>
                    {% if (app.user and app.user.type!='Type') %}
                        <a id="see-tom-js" style="font-size:smaller" class="btn btn-sm {{details.avis.nbr > 0 ? 'bg_vert': 'bg_orange' }}" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="showListAvie()">
                            <span class="nbr_avis_golf_jheo_js">{{details.avis.nbr}}</span> avis
                        </a>
                    {% elseif ( app.user and app.user.type is same as('Type') )%}
                        <a id="see-tom-js" style="font-size:smaller" class="btn btn-sm btn-secondary" onclick="openSwalProfilUnCompleted()">
                            <span class="nbr_avis_golf_jheo_js">{{details.avis.nbr}}</span> avis
                        </a>
                    {% else %}
                        <a id="see-tom-js" style="font-size:smaller" class="btn btn-sm btn-secondary" onclick="openSwalActif()">
                            <span class="nbr_avis_golf_jheo_js">{{details.avis.nbr}}</span> avis
                        </a>
                    {% endif %}
                </span>


                {% if (app.user and app.user.type!='Type') %}
                    <button style="font-size:smaller" type="button" class="mx-2 btn btn-sm btn-primary" data-status="create" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#modalAvis">Donner votre avis</button>
                {% elseif ( app.user and app.user.type is same as('Type') )%}
                    <button style="font-size:smaller" type="button" class="mx-2 btn btn-sm btn-secondary " data-bs-toggle="tooltip" data-bs-placement="top" title="Veuillez vous connecter, pour envoyer votre avis." onclick="openSwalProfilUnCompleted()">Donner votre avis</button>
                {% else %}
                    <button style="font-size:smaller" type="button" class="mx-2 btn btn-sm btn-secondary " data-bs-toggle="tooltip" data-bs-placement="top" title="Veuillez vous connecter, pour envoyer votre avis." onclick="openSwalActif()">Donner votre avis</button>
                {% endif %}
            </div>
        </div>

        <hr>
 
        {# ///codePostal #}
        {% if details.cp %}
            <div class="content_activite">
                <p class="activite">
                    <span class="fw-bold">Code Postal:</span>
                    {{details.cp  | raw}}
                </p>
            </div>
            <hr>
        {% endif %}

        {% if details.nomCommune %}
            <div class="content_activite">
                <p class="activite">
                    <span class="fw-bold">Commune:</span>
                    {{details.nomCommune  | raw}}
                </p>
            </div>
            <hr>
        {% endif %}


        {% if details.telephone %}
            <div class="content_activite">
                <p class="activite">
                    <span class="fw-bold">Telephone:</span>
                        {{details.telephone | raw}}
                </p>
            </div>
            <hr>
        {% endif %}

        {% if details.adr1 %}
            <div class="content_activite">
                <p class="activite">
                    <span class="fw-bold">Adress:</span>
                    {{details.adr1 | raw}}
                </p>
            </div>
            <hr>
        {% endif %}

        <hr>

        {# ///content cta #}
        <div class="content_tow_cta mt-4">
            {% if (app.user and app.user.type!='Type') %}
                <div class="site_web">
                    <a class="{{ app.user ? 'btn btn-outline-success ' : 'btn btn-outline-success disabled' }}" href="{{details.siteWeb | raw}}" target="_blank">
                        Lien :  Site Web
                    </a>
                </div>
            {% else %}
                <div class="site_web btn_gris_actif_js_Elie" data-bs-toggle="tooltip" data-bs-placement="top" title="Veuillez vous connecter, pour accéder au lien site web de ce golf." onclick="openSwalActif()">
                    <a class="{{ app.user ? 'btn btn-outline-success ' : 'btn btn-outline-success disabled' }}" href="{{details.siteWeb | raw}}" target="_blank">
                        Lien :  Site Web
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
</div>